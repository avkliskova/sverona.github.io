<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Project Euler 1-100 in 49 hours | S. Verona Li≈°kov√°</title>
<meta name="title" content="Project Euler 1-100 in 49 hours" />
<meta name="description" content="The things I do for my inner child." />
<meta name="keywords" content="mathematics,code,fun,challenge,project-euler,2021," />


<meta property="og:title" content="Project Euler 1-100 in 49 hours" />
<meta property="og:description" content="The things I do for my inner child." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sverona.dev/blog/project-euler/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2021-01-20T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-20T00:00:00+00:00" />




<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Project Euler 1-100 in 49 hours"/>
<meta name="twitter:description" content="The things I do for my inner child."/>



<meta itemprop="name" content="Project Euler 1-100 in 49 hours">
<meta itemprop="description" content="The things I do for my inner child."><meta itemprop="datePublished" content="2021-01-20T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-01-20T00:00:00+00:00" />
<meta itemprop="wordCount" content="778">
<meta itemprop="keywords" content="mathematics,code,fun,challenge,project-euler,2021," />
<meta name="referrer" content="no-referrer-when-downgrade" />

  
  <link href="https://sverona.dev/fonts/fonts.css" type="text/css" rel="stylesheet" />
  
  
  <link href="https://sverona.dev/sass/style.css" type="text/css" rel="stylesheet" />
  <link href="https://sverona.dev/sass/sidenotes.css" type="text/css" rel="stylesheet" />
  
    <link href="https://sverona.dev/katex/katex.min.css" type="text/css" rel="stylesheet" />
    <script defer src="https://sverona.dev/katex/katex.js"></script>
    <script defer src="https://sverona.dev/katex/contrib/auto-render.js"></script>
  

  <script>
    // @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&dn=gpl-3.0.txt GPL-3.0

    
    document.addEventListener("DOMContentLoaded", () => {
          renderMathInElement(document.body, {
            delimiters: [
                {left: "\\(", right: "\\)", display: false},
                {left: "\\[", right: "\\]", display: true}
            ],
            
            
            trust: (context) => ['\\htmlId', '\\href'].includes(context.command),
            macros: {
              "\\eqref": "\\href{###1}{(\\text{#1})}",
              "\\ref": "\\href{###1}{\\text{#1}}",
              "\\label": "\\htmlId{#1}{}"
            }
        })
      });
    

    document.addEventListener("DOMContentLoaded", () => {
      var els = document.getElementsByClassName("highlight");
      for (var i = 0; i < els.length; i++) {
        if (els[i].title.length) {
          var newNode = document.createElement("code");
          var textNode = document.createTextNode(els[i].title);
          newNode.appendChild(textNode);
          newNode.classList.add("highlight-title");
          var pre = els[i].querySelector('pre');
          pre.appendChild(newNode);
        }
      }
    });
    // @license-end
  </script>

</head>

<body>
  <header id="header"><a href="/" class="title" id="brand">
  <img src="/favicon.ico"> <strong>S. Verona Li≈°kov√°</strong>
</a>
<nav><ul class="horizontal-list">

<li><a href="/about">about</a></li>

</ul>
</nav>
</header>
  <main><noscript>
  <section style="background-color: #e6e8fa; margin-block: 1rem; padding: 1px 1rem; box-shadow: 2px 2px #000">
    <p>Hello, sentient being who has disabled JavaScript/is using <a href="https://www.gnu.org/software/librejs/index.html">LibreJS</a>!</p>
    <p>This site uses as little JavaScript as I can get away with, but it does require JS to:</p>
<ol>
  <li>render mathematics; for this purpose I use <a href="https://katex.org">KaTeX</a>, which is freely licensed (and partially trans-made! üè≥Ô∏è‚Äçüåà)</li>
  <li>slightly extend Hugo's <a href="https://gohugo.io/content-management/syntax-highlighting/#highlight-shortcode">highlight shortcode</a> to show filenames in code listings. (The actual syntax highlighting is done server-side.)</li>
</ol>
    <p>This site validates under LibreJS as of 6 September 2022. If you find otherwise, please contact me.</p>
  </section>
</noscript>

<header id="front-matter">
  <h1>Project Euler 1-100 in 49 hours</h1>
  <p class="subtitle"><date>20 January 2021</date></p>
  
  <ul class="horizontal-list page-tags">
      
        <li><a href="https://sverona.dev/tags/mathematics/">mathematics</a></li>
      
        <li><a href="https://sverona.dev/tags/code/">code</a></li>
      
        <li><a href="https://sverona.dev/tags/fun/">fun</a></li>
      
        <li><a href="https://sverona.dev/tags/challenge/">challenge</a></li>
      
        <li><a href="https://sverona.dev/tags/project-euler/">project-euler</a></li>
      
        <li><a href="https://sverona.dev/tags/2021/">2021</a></li>
      
  </ul>
  
</div>
</header>

<article>
  
  <div id="toc" class="margin-toggle margin-left">
    <h2>Table of Contents</h2>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#how-this-was-possible-in-the-first-place">How this was possible in the first place</a></li>
    <li><a href="#useful-things-from-my-graduate-algorithms-class">Useful things from my graduate algorithms class</a></li>
    <li><a href="#utility-algorithms">Utility algorithms</a>
      <ul>
        <li><a href="#converting-between-a-number-and-its-digits">Converting between a number and its digits</a></li>
        <li><a href="#euclid-s-gcd-algorithm">Euclid&rsquo;s GCD algorithm</a></li>
        <li><a href="#primality-testing">Primality testing</a></li>
        <li><a href="#sieve-of-eratosthenes">Sieve of Eratosthenes</a></li>
        <li><a href="#factorization">Factorization</a></li>
        <li><a href="#generating-pythagorean-triples">Generating Pythagorean triples</a></li>
        <li><a href="#others">Others</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
  
  <p><a href="https://projecteuler.net">Project Euler</a> is how I taught myself Python in high school, and so I find it incredibly nostalgic. It took 13-year-old me a lot of Googling and a few months to get through the first 100 problems.<label for="sidenote-0" class="margin-toggle sidenote-number "></label><input type="checkbox" id="sidenote-0" class="margin-toggle"/><span class="sidenote "> Why 100 specifically? Because I wanted to write this post honestly and those are the ones I&rsquo;m allowed to talk about without them locking my account or something.</span></p>
<p>10-odd years and a graduate degree later, I decided to come back and solve them as fast as I could. I&rsquo;m no competitive programmer, but 24 hours seemed reasonable. Fortunately, I lack the stamina to code for that long, so I did it over a few days instead. I started on 19 January a little after 1400 and finished two days later at 1500, and probably spent less than half of that time coding, but who knows.</p>
<h2 id="how-this-was-possible-in-the-first-place">How this was possible in the first place</h2>
<p>Having solved them all before helped a lot &mdash; otherwise I wouldn&rsquo;t be sure this was possible to do quickly at all. Problems after 100 tend to very quickly become about number theory; I&rsquo;ve solved more than one by appeal to my copy of Hardy and Wright.</p>
<p>I wrote my solutions in Python, as before. Having just done <a href="https://adventofco.de">Advent of Code</a> in plain C, I came to miss my dictionaries, lists, and not having to write <code>unsigned long long</code> everywhere.</p>
<h2 id="useful-things-from-my-graduate-algorithms-class">Useful things from my graduate algorithms class</h2>
<p><a href="https://projecteuler.net/problem=67">Problem 67</a> was how I learned about dynamic programming in high school.</p>
<h2 id="utility-algorithms">Utility algorithms</h2>
<p>If you&rsquo;re trying this in another language, these are the things I would implement first.</p>
<h3 id="converting-between-a-number-and-its-digits">Converting between a number and its digits</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="font-weight:bold">def</span> <span style="color:#666;font-weight:bold;font-style:italic">digits</span>(n):
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">return</span> [<span style="font-weight:bold;font-style:italic">int</span>(d) <span style="font-weight:bold">for</span> d <span style="font-weight:bold">in</span> <span style="font-weight:bold;font-style:italic">str</span>(n)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">def</span> <span style="color:#666;font-weight:bold;font-style:italic">from_digits</span>(digits):
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">return</span> <span style="font-weight:bold;font-style:italic">int</span>(<span style="color:#666;font-style:italic">&#39;&#39;</span>.join(<span style="font-weight:bold;font-style:italic">str</span>(d) <span style="font-weight:bold">for</span> d <span style="font-weight:bold">in</span> digits))
</span></span></code></pre></div><h3 id="euclid-s-gcd-algorithm">Euclid&rsquo;s GCD algorithm</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="font-weight:bold">def</span> <span style="color:#666;font-weight:bold;font-style:italic">gcd</span>(a, b):
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">return</span> a <span style="font-weight:bold">if</span> b == 0 <span style="font-weight:bold">else</span> gcd(b, a % b)
</span></span></code></pre></div><h3 id="primality-testing">Primality testing</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="font-weight:bold">def</span> <span style="color:#666;font-weight:bold;font-style:italic">is_prime</span>(n):
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">if</span> n &lt; 2:
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">return</span> <span style="font-weight:bold">False</span>
</span></span><span style="display:flex;"><span>    max_d = <span style="font-weight:bold;font-style:italic">int</span>(n ** 0.5)
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">for</span> d <span style="font-weight:bold">in</span> <span style="font-weight:bold;font-style:italic">range</span>(2, max_d + 1):
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">if</span> n % d == 0:
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">return</span> <span style="font-weight:bold">False</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">return</span> <span style="font-weight:bold">True</span>
</span></span></code></pre></div><h3 id="sieve-of-eratosthenes">Sieve of Eratosthenes</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="font-weight:bold">def</span> <span style="color:#666;font-weight:bold;font-style:italic">sieve</span>(max_n):
</span></span><span style="display:flex;"><span>    sv = [<span style="font-weight:bold">None</span> <span style="font-weight:bold">for</span> n <span style="font-weight:bold">in</span> <span style="font-weight:bold;font-style:italic">range</span>(max_n + 1)]
</span></span><span style="display:flex;"><span>    sv[0] = <span style="font-weight:bold">False</span>
</span></span><span style="display:flex;"><span>    sv[1] = <span style="font-weight:bold">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    max_p = <span style="font-weight:bold;font-style:italic">int</span>(max_n ** 0.5)
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">for</span> p <span style="font-weight:bold">in</span> <span style="font-weight:bold;font-style:italic">range</span>(2, max_p + 1):
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">if</span> sv[p] <span style="font-weight:bold">is</span> <span style="font-weight:bold">None</span>:
</span></span><span style="display:flex;"><span>            sv[p] = <span style="font-weight:bold">True</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">for</span> c <span style="font-weight:bold">in</span> <span style="font-weight:bold;font-style:italic">range</span>(p * p, max_n + 1, p):
</span></span><span style="display:flex;"><span>            sv[c] = <span style="font-weight:bold">False</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">for</span> p <span style="font-weight:bold">in</span> <span style="font-weight:bold;font-style:italic">range</span>(max_p + 1, max_n + 1):
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">if</span> sv[p] <span style="font-weight:bold">is</span> <span style="font-weight:bold">None</span>:
</span></span><span style="display:flex;"><span>            sv[p] = <span style="font-weight:bold">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">return</span> sv
</span></span></code></pre></div><p>Sieving other things was also appropriate; for instance, Euler&rsquo;s totient function, in view of the identity
\[
\varphi(n) = n \cdot \prod_{\substack{p \mid n}} \frac{p-1}p.
\]</p>
<h3 id="factorization">Factorization</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="font-weight:bold">def</span> <span style="color:#666;font-weight:bold;font-style:italic">factors</span>(n):
</span></span><span style="display:flex;"><span>    n_ = n
</span></span><span style="display:flex;"><span>    max_d = <span style="font-weight:bold;font-style:italic">int</span>(n ** 0.5)
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">for</span> d <span style="font-weight:bold">in</span> <span style="font-weight:bold;font-style:italic">range</span>(2, max_d + 1):
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">if</span> n_ &lt; d:
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">break</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">if</span> is_prime(d) <span style="font-weight:bold">and</span> n_ % d == 0:
</span></span><span style="display:flex;"><span>            mult = 0
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">while</span> n_ % d == 0:
</span></span><span style="display:flex;"><span>                n_ //= d
</span></span><span style="display:flex;"><span>                mult += 1
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">yield</span> (d, mult)
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">if</span> n_ &gt; 1:
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">yield</span> (n_, 1)
</span></span></code></pre></div><h3 id="generating-pythagorean-triples">Generating Pythagorean triples</h3>
<p>They really like their Pythagorean triples at Project Euler. The code below generates all the primitive triples \((a, b, c)\) with \(c\) less than a provided bound, then their multiples.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="font-weight:bold">def</span> <span style="color:#666;font-weight:bold;font-style:italic">pyth</span>(max_c):
</span></span><span style="display:flex;"><span>    max_m = <span style="font-weight:bold;font-style:italic">int</span>((max_c / 2) ** 0.5)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">for</span> m <span style="font-weight:bold">in</span> <span style="font-weight:bold;font-style:italic">range</span>(1, max_m + 1):
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">for</span> n <span style="font-weight:bold">in</span> <span style="font-weight:bold;font-style:italic">range</span>(1, m):
</span></span><span style="display:flex;"><span>            a = m * m - n * n
</span></span><span style="display:flex;"><span>            b = 2 * m * n
</span></span><span style="display:flex;"><span>            c = m * m + n * n
</span></span><span style="display:flex;"><span>            max_k = max_c // c
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">for</span> k <span style="font-weight:bold">in</span> <span style="font-weight:bold;font-style:italic">range</span>(1, max_k + 1):
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">yield</span> (k * a, k * b, k * c)
</span></span></code></pre></div><h3 id="others">Others</h3>
<p>The <strong>extended Euclidean algorithm</strong>, which is convenient for generating modular inverses for something like the Chinese Remainder Theorem (which wasn&rsquo;t necessary here, but definitely is later on.)</p>
<p><strong>Generating continued fractions</strong>, particularly of quadratic surds.</p>
<p>For later problems, <strong>a fast primality test</strong> is a good idea. Here&rsquo;s the Miller-Rabin test:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="font-weight:bold">def</span> <span style="color:#666;font-weight:bold;font-style:italic">is_probably_prime</span>(n, witnesses=<span style="font-weight:bold">None</span>):
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">if</span> n &lt; 2:
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">return</span> <span style="font-weight:bold">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">if</span> <span style="font-weight:bold">not</span> witnesses:
</span></span><span style="display:flex;"><span>        witnesses = [2, 3, 5, 7, 11, 13, 17]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">if</span> n <span style="font-weight:bold">in</span> witnesses:
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">return</span> <span style="font-weight:bold">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    odd_divisor = n - 1
</span></span><span style="display:flex;"><span>    power_of_two = 0
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">while</span> odd_divisor &amp; 1 == 0:
</span></span><span style="display:flex;"><span>        power_of_two += 1
</span></span><span style="display:flex;"><span>        odd_divisor //= 2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">for</span> witness <span style="font-weight:bold">in</span> witnesses:
</span></span><span style="display:flex;"><span>        x = <span style="font-weight:bold;font-style:italic">pow</span>(witness, odd_divisor, n)
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">if</span> x <span style="font-weight:bold">not</span> <span style="font-weight:bold">in</span> [1, n - 1]:
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">for</span> _ <span style="font-weight:bold">in</span> <span style="font-weight:bold;font-style:italic">range</span>(power_of_two - 1):
</span></span><span style="display:flex;"><span>                x = (x * x) % n
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">if</span> x == n - 1:
</span></span><span style="display:flex;"><span>                    <span style="font-weight:bold">break</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">return</span> <span style="font-weight:bold">False</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">return</span> <span style="font-weight:bold">True</span>
</span></span></code></pre></div><p>This is valid up to about \(n = 3.4 \times 10^{14},\) which exceeds most of the answer bounds in early problems. Using the witness set \(\{2, 7, 61\}\) may provide a slight speed boost, but if you&rsquo;re hyperoptimizing your solutions like that this post probably isn&rsquo;t for you.</p>

</article>

  </main>
  <footer></footer>

    
</body>

</html>
