<!doctype html><html lang=en-us>
<head>
<meta http-equiv=x-clacks-overhead content="GNU Terry Pratchett">
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>The dual simplex method, an introduction | S. Verona Malone</title>
<meta name=title content="The dual simplex method, an introduction">
<meta name=description content="A term paper for an operations research class.">
<meta name=keywords content="mathematics,grad-school,term-paper,2019,operations-research,linear-operators,">
<meta property="og:title" content="The dual simplex method, an introduction">
<meta property="og:description" content="A term paper for an operations research class.">
<meta property="og:type" content="article">
<meta property="og:url" content="./blog/dual-simplex/"><meta property="article:section" content="blog">
<meta property="article:published_time" content="2019-04-01T00:00:00+00:00">
<meta property="article:modified_time" content="2019-04-01T00:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="The dual simplex method, an introduction">
<meta name=twitter:description content="A term paper for an operations research class.">
<meta itemprop=name content="The dual simplex method, an introduction">
<meta itemprop=description content="A term paper for an operations research class."><meta itemprop=datePublished content="2019-04-01T00:00:00+00:00">
<meta itemprop=dateModified content="2019-04-01T00:00:00+00:00">
<meta itemprop=wordCount content="2440">
<meta itemprop=keywords content="mathematics,grad-school,term-paper,2019,operations-research,linear-operators,">
<meta name=referrer content="no-referrer-when-downgrade">
<link href=/css/base.css type=text/css rel=stylesheet>
<link href=/css/sidenotes.css type=text/css rel=stylesheet>
<link href=/css/latex-theorem.css type=text/css rel=stylesheet>
<link href=/katex/katex.css type=text/css rel=stylesheet>
<script defer src=/katex/katex.js></script>
<script defer src=/katex/contrib/auto-render.js></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"\\(",right:"\\)",display:!1},{left:"\\begin{align}",right:"\\begin{align}",display:!0},{left:"\\[",right:"\\]",display:!0}]})})</script>
</head>
<body>
<header id=header><a href=/./ class=title id=brand>
<span id=accent></span>S. Verona Malone
</a>
<nav><ul>
<li><a href=blog>blog</a></li>
<li><a href=projects>projects</a></li>
<li><a href=https://github.com/sverona>github</a></li>
<li><a href=about>about</a></li>
</ul>
</nav>
</header>
<main>
<header id=front-matter>
<nav id=sequence-nav>
<div id=next-prev>
<div id=next><a href=./blog/nabla/>Neural networks in time scale calculus</a></div>
<div></div>
</div>
</nav>
<div id=metadata>
<div>
<h1>The dual simplex method, an introduction</h1>
<em id=page-description>A term paper for an operations research class.</em>
</div>
<ul id=page-metadata-block>
<li id=publish-date>
<time datetime=2019-04-01 pubdate>
April 1, 2019
</time>
</li>
<li id=completion-status>completion status: <em>complete</em></li>
<li id=epistemic-status>epistemic status: <em>confident</em></li>
</ul>
</div>
</header>
<article>
<p>The primal <em>simplex method</em> provides an algorithmic means for solving
linear programs (hereinafter <em>LPs</em>.) This document motivates, defines,
and applies the so-called <em>dual simplex method</em>, a slight variant which
is useful for performing <em>post hoc</em> sensitivity analysis on LPs solved
by the simplex method.</p>
<h2 id=the-primal-simplex-method>The primal simplex method</h2>
<p>In this section, we review the three steps of the usual primal method,
following [Hillier-Lieberman],<label for=sidenote-0 class="margin-toggle sidenote-number"></label>
<input type=checkbox id=sidenote-0 class=margin-toggle><span class=sidenote>Frederick S. Hillier and Gerald J. Lieberman, <em>Introduction to operations research</em>, 10th ed., 2014.</span>
section 5.2.<label for=sidenote-1 class="margin-toggle sidenote-number"></label>
<input type=checkbox id=sidenote-1 class=margin-toggle><span class=sidenote>This assumes the LP has been augmented by adding slack variables and/or artificial variables as necessary so that its constraints are in the form \(\mathbf{Ax} + \mathbf{Ix_s} = \mathbf{b}\).)</span></p>
<ol>
<li>
<p><em>Initialization</em>: Obtain an initial feasible solution \(\mathbf{x}\).</p>
</li>
<li>
<p><em>Test for optimality</em>: Check whether there are negative objective
coefficients. If there are none, stop; an optimal solution has been
attained. Otherwise, proceed with step 3.</p>
</li>
<li>
<p><em>Iteration</em>:</p>
<ol>
<li><em>Determine the entering basic variable.</em> This is done by
identifying the column in which the most negative objective
coefficient occurs.</li>
<li><em>Determine the leaving basic variable.</em> This is done by performing
a <em>minimum ratio test</em>: among the rows with positive entries in
the entering basic variable&rsquo;s column, choose the one whose ratio
of right-hand side to that column&rsquo;s entry is the smallest. The
basic variable in that row is thereby chosen to leave the basis.</li>
<li><em>Perform a change of basis.</em> This is done by performing row
operations to transform the coefficients in the entering basic
variable&rsquo;s column to match the current coefficients in the leaving
basic variable&rsquo;s column.</li>
</ol>
</li>
<li>
<p>Go to step 2.</p>
</li>
</ol>
<h2 id=example>Example</h2>
<p>Consider the LP</p>
<p>\[\begin{aligned} \textrm{maximize} \qquad & z(\mathbf{x}) = 40x_1 +
70x_2 \newline \textrm{subject to} \qquad & x_1 + x_2 \leq 100 \newline & 10x_1 +
50x_2 \leq 4000 \newline \textrm{and} \qquad & x_{1,2} \geq 0. \end{aligned}\]</p>
<p>This LP models the following toy problem:</p>
<blockquote>
<p>A forestry company has \(100\) acres of timber available for harvest.
There are two options for treating the land after felling the timber
(at a cost of \(10000\) USD per acre); either do nothing (which will
return \(50000\) USD per acre,) or replant the land (which will &mdash;
eventually &mdash; return \(120000\) USD per acre, but costs an additional
\(40000\) USD per acre.) The company has \(4000000\) USD available and
wishes to maximize total profit. How many acres of land should be
replanted, and how many should be left alone?</p>
</blockquote>
<p>The decision variables \(x_1\) and \(x_2\) represent the quantity of
land to be left alone (replanted.) The first constraint \(x_1 + x_2 \leq
100\) represents the constraint on available land; the second constraint
\(10x_1 + 50x_2 \leq 4000\) represents the constraint on available
capital (measured in units of \(1000\) USD.)</p>
<p>Solving this program by the simplex method proceeds as follows. We first
augment the problem with slack variables \(x_3 = 100 - (x_1 + x_2)\),
\(x_4 = 4000 - (10x_1 + 50x_2)\), giving the form</p>
<p>\[\begin{aligned} \textrm{maximize} \qquad & z(\mathbf{x}) = 40x_1 +
70x_2 \newline \textrm{subject to} \qquad & x_1 + x_2 + x_3 = 100 \newline & 10x_1 +
50x_2 + x_4 = 4000 \newline \textrm{and} \qquad & x_{1,2,3,4} \geq 0.
\end{aligned}\]</p>
<p>The initial simplex tableau is</p>
<p>\[\begin{array}{|c|c|rrrrr|r|} \hline \textbf{BV} & \textbf{Eq&rsquo;n} &
\mathbf{z} & \mathbf{x_1} & \mathbf{x_2} & \mathbf{x_3} & \mathbf{x_4} &
\textbf{RHS} \newline \hline z & 0 & 1 & -40 & -70 & 0 & 0 & 0 \newline x_3 & 1 & 0
& 1 & 1 & 1 & 0 & 100 \newline x_4 & 2 & 0 & 10 & 50 & 0 & 1 & 4000 \newline \hline
\end{array}\]</p>
<h3 id=iteration-1>Iteration 1</h3>
<p>First, we note that the present solution is not optimal (since \(x_1\)
and \(x_2\) have negative coefficients in row 0.)</p>
<p>The more negative coefficient is associated with \(x_2\), so we choose
it to enter the basis.</p>
<p>Performing a minimum ratio test, we have (for \(x_3\)) \(100 / 1 = 100\)
and (for \(x_4\)) \(4000 / 50 = 80\). Since \(x_4\) has the lower ratio,
we choose it to enter the basis.</p>
<p>So we pivot on the \(50\) in \(x_2\)&rsquo;s column and \(x_4\)&rsquo;s row:</p>
<p>\[\begin{array}{|c|c|rrrrr|r|} \hline \textbf{BV} & \textbf{Eq&rsquo;n} &
\mathbf{z} & \mathbf{x_1} & \mathbf{x_2} & \mathbf{x_3} & \mathbf{x_4} &
\textbf{RHS} \newline \hline z & 0 & 1 & -40 & -70 & 0 & 0 & 0 \newline x_3 & 1 & 0
& 1 & 1 & 1 & 0 & 100 \newline x_4 & 2 & 0 & 10 & \boxed{50} & 0 & 1 & 4000\newline
\hline \end{array}\]</p>
<p>That is to say, we perform row operations to force the coefficients in
\(x_2\)&rsquo;s column to match the current coefficients in \(x_4\)&rsquo;s
column: - divide the \(x_4\) row by \(50\), - subtract \(1\) times the
resulting row from the \(x_3\) row, - and subtract \(-70\) times the
resulting row from the \(z\) row.</p>
<p>Doing this gives the new tableau</p>
<p>\[\begin{array}{|c|c|rrrrr|r|} \hline \textbf{BV} & \textbf{Eq&rsquo;n} &
\mathbf{z} & \mathbf{x_1} & \mathbf{x_2} & \mathbf{x_3} & \mathbf{x_4} &
\textbf{RHS} \newline \hline z & 0 & 1 & -26 & 0 & 0 & 7/5 & 5600 \newline x_3 & 1 &
0 & 4/5 & 0 & 1 & -1/50 & 20 \newline x_2 & 2 & 0 & 1/5 & 1 & 0 & 1/50 & 80\newline
\hline \end{array}\]</p>
<p>Note that we&rsquo;ve updated the basic-variable list in the leftmost column
accordingly.</p>
<h3 id=iteration-2>Iteration 2</h3>
<p>The present solution is still not optimal, since there is a \(-26\) in
the objective row.</p>
<p>It&rsquo;s in \(x_1\)&rsquo;s column, so \(x_1\) will enter the basis.</p>
<p>Since \(20 / (4/5) = 25 &lt; 400 = 80 / (1/5)\), \(x_3\) will leave the
basis.</p>
<p>So we&rsquo;ll pivot on the \(4/5\) in \(x_1\)&rsquo;s column and \(x_3\)&rsquo;s row.
This gives the tableau</p>
<p>\[\begin{array}{|c|c|rrrrr|r|} \hline \textbf{BV} & \textbf{Eq&rsquo;n} &
\mathbf{z} & \mathbf{x_1} & \mathbf{x_2} & \mathbf{x_3} & \mathbf{x_4} &
\textbf{RHS} \newline \hline z & 0 & 1 & 0 & 0 & 75/2 & 3/4 & 6250 \newline x_1 & 1
& 0 & 1 & 0 & 5/4 & -1/40 & 25 \newline x_2 & 2 & 0 & 0 & 1 & -1/4 & 1/40 &
75\newline \hline \end{array}\]</p>
<p>This solution is optimal.</p>
<h2 id=duality-theory>Duality theory</h2>
<p>Recall that to any (primal) LP \[\begin{aligned} \textrm{maximize}
\qquad& z(\mathbf{x}) = \mathbf{c} \mathbf{x} \newline \textrm{subject to}
\qquad& \mathbf{Ax} \leq \mathbf{b}\newline \textrm{and} \qquad& \mathbf{x}
\geq \mathbf{0} \end{aligned} \] we may associate a <em>dual</em> LP</p>
<p>\[\begin{aligned} \textrm{minimize} \qquad& w(\mathbf{y}) = \mathbf{y}
\mathbf{b} \newline \textrm{subject to} \qquad& \mathbf{yA} \geq \mathbf{c}\newline
\textrm{and} \qquad& \mathbf{y} \geq \mathbf{0} \end{aligned}\]
(where \(\mathbf{y}\) is a row vector,)
or, equivalently, \[\begin{aligned}
\textrm{minimize} \qquad& w(\mathbf{y}) = \mathbf{b}^\top\mathbf{y} \newline
\textrm{subject to} \qquad& \mathbf{A}^\top\mathbf{y} \geq
\mathbf{c}^\top\newline \textrm{and} \qquad& \mathbf{y} \geq \mathbf{0}
\end{aligned}\] (where \(\mathbf{y}\) is a column vector.)</p>
<h2 id=example-1>Example</h2>
<p>The foregoing (primal) LP has dual</p>
<p>\[\begin{aligned} \textrm{minimize} \qquad & w(\mathbf{y}) = 100y_1 +
4000y_2 \newline \textrm{subject to} \qquad & y_1 + 10y_2 \geq 40 \newline & y_1 +
50y_2 \geq 70 \newline \textrm{and} \qquad & y_{1,2} \geq 0. \end{aligned}\]</p>
<p>This LP may be thought of as modeling the problem of finding an <em>upper
bound</em> for the primal LP as a linear combination of constraints, where
the variables \(y_i\) represent the multiplier of the \(i\)th
constraint.</p>
<h2 id=motivating-the-dual-simplex-method>Motivating the dual simplex method</h2>
<p>An important property of the primal simplex method is that the solution
attained at each iteration is (primal) feasible.<label for=sidenote-2 class="margin-toggle sidenote-number"></label>
<input type=checkbox id=sidenote-2 class=margin-toggle><span class=sidenote>This is assured
inductively by the minimum ratio test.</span>
Similarly, the dual simplex
method attains a <em>dual</em>-feasible solution at each iteration.</p>
<p>Therefore, if perturbing a primal problem causes the new final solution
to be dual-feasible but not primal-feasible, the dual simplex method may
be used to attain the new optimal solution.</p>
<p>An important point to note is that the dual simplex method is, in a
sense, the dual <em>algorithm</em> of the ordinary simplex method. It is not
the same as just applying the ordinary simplex method to the dual,
although it performs almost all the same calculations. In particular, it
operates on the primal tableau rather than the dual tableau.</p>
<h2 id=applying-the-dual-simplex-method>Applying the dual simplex method</h2>
<ol>
<li>
<p><em>Initialization</em>: Obtain an initial dual-feasible solution
\(\mathbf{y}\). In practice, this will be given by a final primal
tableau.</p>
</li>
<li>
<p><em>Test for feasibility</em>: Check whether there are negative right-hand
sides. If there are none, stop; an primal-feasible (and hence
primal-optimal) solution has been attained. Otherwise, proceed with
step 3.</p>
</li>
<li>
<p><em>Iteration</em>:</p>
<ol>
<li><em>Determine the leaving basic variable.</em> This has already been done
by identifying the row in which the negative right-hand side
occurs.</li>
<li><em>Determine the entering basic variable.</em> Among those columns in
the pivot row whose coefficient is negative, choose the one whose
ratio of that coefficient to its corresponding objective
coefficient is minimized (in absolute value.)</li>
<li><em>Perform a change of basis.</em> This is done as before.</li>
</ol>
</li>
<li>
<p>Go to step 2.</p>
</li>
</ol>
<p>Note that the variables to be exchanged in the basis are determined in
the opposite order of the primal simplex method. This reflects the fact
that (after augmenting both problems) any variable that is basic in the
primal corresponds to a nonbasic variable in the dual, and vice versa.</p>
<h2 id=example-2>Example</h2>
<p>Suppose the forestry company decides to sell 25 acres of its land at the
price of \(6000\) USD an acre. Then the right-hand sides in the primal
LP (ref) are changed, giving the problem</p>
<p>\[\begin{aligned} \textrm{maximize} \qquad & z(\mathbf{x}) = 40x_1 +
70x_2 \newline \textrm{subject to} \qquad & x_1 + x_2 \leq 75 \newline & 10x_1 +
50x_2 \leq 4150 \newline \textrm{and} \qquad & x_{1,2} \geq 0. \end{aligned}\]</p>
<p>That is, there are \(25\) fewer acres of land and \(150000\) USD more
than in the original setup.</p>
<p>The optimal solution we found in the original problem \((25, 75)\) is
not primal-feasible in this new problem, but it is dual-feasible, as may
be checked.</p>
<p>We would like to find the new optimal solution for this perturbed
problem without effectively retracing the steps we took to solve the
original problem.</p>
<p>So we start with the final tableau from the original problem, which was</p>
<p>\[\begin{array}{|c|c|rrrrr|r|} \hline \textbf{BV} & \textbf{Eq&rsquo;n} &
\mathbf{z} & \mathbf{x_1} & \mathbf{x_2} & \mathbf{x_3} & \mathbf{x_4} &
\textbf{RHS} \newline \hline z & 0 & 1 & 0 & 0 & 75/2 & 3/4 & 6250 \newline x_1 & 1
& 0 & 1 & 0 & 5/4 & -1/40 & 25 \newline x_2 & 2 & 0 & 0 & 1 & -1/4 & 1/40 &
75\newline \hline \end{array}\]</p>
<p>This was arrived at after a series of row operations, the net effect of
which was to transform the coefficients of the slack variables \(x_3\)
and \(x_4\) from the identity matrix to</p>
<p>\[\mathbf{B}^{-1} = \begin{bmatrix} 5/4 & -1/40 \newline -1/4 & 1/40
\end{bmatrix}.\]</p>
<p>As can be verified, the entire rows 1 and 2 of the final tableau can be
obtained by simply premultiplying the initial rows 1 and 2 by this
matrix.</p>
<p>Suppose we started instead with the appropriate initial tableau for the
new problem, with modified right sides, and performed all the same row
operations. Then &mdash; multiplying through by \(\mathbf{B}^{-1}\) &mdash; we
find that the variable coefficients will be the same, and the new
right-hand sides will be given by</p>
<p>\[\begin{bmatrix} 5/4 & -1/40 \newline -1/4 & 1/40
\end{bmatrix}\begin{bmatrix} 75 \newline 4150 \end{bmatrix} = \begin{bmatrix}
-10 \newline 85\end{bmatrix} .\]</p>
<p>So the <em>initial</em> tableau for the dual simplex method will be</p>
<p>\[\begin{array}{|c|c|rrrrr|r|} \hline \textbf{BV} & \textbf{Eq&rsquo;n} &
\mathbf{z} & \mathbf{x_1} & \mathbf{x_2} & \mathbf{x_3} & \mathbf{x_4} &
\textbf{RHS} \newline \hline z & 0 & 1 & 0 & 0 & 75/2 & 3/4 & 5550 \newline x_1 & 1
& 0 & 1 & 0 & 5/4 & -1/40 & -10 \newline x_2 & 2 & 0 & 0 & 1 & -1/4 & 1/40 &
85 \newline \hline \end{array}\]</p>
<h3 id=iteration-1-1>Iteration 1</h3>
<p>We observe that the solution is not primal-feasible, since there is a
\(-10\) in the right-hand side. Since this is in \(x_1\)&rsquo;s row, \(x_1\)
will leave the basis.</p>
<p>To select the entering basic variable, we examine the variables in
\(x_1\)&rsquo;s row with negative coefficients. There is only one, the
\(-1/40\) in \(x_4\)&rsquo;s column, so \(x_4\) will enter the basis.<label for=sidenote-3 class="margin-toggle sidenote-number"></label>
<input type=checkbox id=sidenote-3 class=margin-toggle><span class=sidenote>Were
there more than one, we would compare \(\vert(3/4)/(-1/40)\vert\) to the
corresponding ratios in the other columns, and choose the variable with
the lowest ratio.</span></p>
<p>Thus we pivot on that \(-1/40\): \[\begin{array}{|c|c|rrrrr|r|} \hline
\textbf{BV} & \textbf{Eq&rsquo;n} & \mathbf{z} & \mathbf{x_1} & \mathbf{x_2} &
\mathbf{x_3} & \mathbf{x_4} & \textbf{RHS} \newline \hline z & 0 & 1 & 0 & 0 &
75/2 & 3/4 & 5550 \newline x_1 & 1 & 0 & 1 & 0 & 5/4 & \boxed{-1/40} & -10\newline
x_2 & 2 & 0 & 0 & 1 & -1/4 & 1/40 & 85 \newline \hline \end{array}\]</p>
<p>This gives</p>
<p>\[\begin{array}{|c|c|rrrrr|r|} \hline \textbf{BV} & \textbf{Eq&rsquo;n} &
\mathbf{z} & \mathbf{x_1} & \mathbf{x_2} & \mathbf{x_3} & \mathbf{x_4} &
\textbf{RHS} \newline \hline z & 0 & 1 & 30 & 0 & 0 & 0 & 5250 \newline x_4 & 1 & 0
& -40 & 0 & -50 & 1 & 400 \newline x_2 & 2 & 0 & 1 & 1 & 1 & 0 & 75 \newline \hline
\end{array}\]</p>
<p>Since there are no longer negative right-hand sides, the present
solution \((0, 75)\) is primal-feasible and hence optimal.</p>
<h2 id=primal-dual-method>Primal-dual method</h2>
<p>The scenarios in which we can immediately apply the dual simplex method
are limited to those in which the starting point is dual-feasible and
primal-infeasible.</p>
<p>Were the starting point instead primal-feasible and dual-infeasible, we
could simply apply the primal simplex method.</p>
<p>The remaining case &ndash; points that are infeasible both in the primal and
the dual &ndash; is a little more involved. We follow [Vanderbei],<label for=sidenote-4 class="margin-toggle sidenote-number"></label>
<input type=checkbox id=sidenote-4 class=margin-toggle><span class=sidenote>Robert J. Vanderbei, <em>Linear programming: foundations and extensions,</em> 3rd ed., 2008</span>
ยง6.5.</p>
<p>We know a solution is primal-feasible (dual-feasible) only if it has no
negative right-hand sides (no negative objective coefficients); so there
must be at least one negative entry in each.</p>
<p>The idea is to solve an <em>intermediate problem</em> given by replacing some
of the offending coefficients with zeros. (This can be done in either
the objective row or the right-hand side column, but not both.) This can
be done by the primal or dual simplex method, depending on whether the
initial intermediate tableau is primal- or dual-feasible.</p>
<p>Once this has been done, the previously zeroed-out negative coefficients
can be restored, which gives an initial feasible solution for the real
problem. This can be solved using the variant of the simplex method that
was not used to solve the intermediate problem.</p>
<p>If the intermediate was solved with the dual simplex method, then it
must have had its negative objective coefficients zeroed out, and
restoring these will give a primal-feasible initial solution, suitable
for initializing the primal simplex method. Similarly, if the
intermediate was solved with the primal simplex method, the real problem
will require the dual simplex method.</p>
<h2 id=references>References</h2>
<p>[Va] Vanderbei [HL] Hillier/Lieberman</p>
</article>
<div class=page-tags>
<a href=./tags/mathematics/>mathematics</a>,
<a href=./tags/grad-school/>grad-school</a>,
<a href=./tags/term-paper/>term-paper</a>,
<a href=./tags/2019/>2019</a>,
<a href=./tags/operations-research/>operations-research</a>,
<a href=./tags/linear-operators/>linear-operators</a>,
</div>
<hr>
</main>
<footer> Made with <a href=https://github.com/sverona/hugo-semiotic>Hugo Semiotic</a>
</footer>
</body>
</html>