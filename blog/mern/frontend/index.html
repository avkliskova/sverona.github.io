<!doctype html><html lang=en-us>
<head>
<meta http-equiv=x-clacks-overhead content="GNU Terry Pratchett">
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>Annotated MERN III: Frontend | S. Verona Malone</title>
<meta name=title content="Annotated MERN III: Frontend">
<meta name=description content="Annotations for the React part of the repo.">
<meta name=keywords content>
<meta property="og:title" content="Annotated MERN III: Frontend">
<meta property="og:description" content="Annotations for the React part of the repo.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://sverona.dev/blog/mern/frontend/"><meta property="article:section" content="blog">
<meta property="article:published_time" content="2021-10-03T00:00:00+00:00">
<meta property="article:modified_time" content="2021-10-03T00:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Annotated MERN III: Frontend">
<meta name=twitter:description content="Annotations for the React part of the repo.">
<meta itemprop=name content="Annotated MERN III: Frontend">
<meta itemprop=description content="Annotations for the React part of the repo."><meta itemprop=datePublished content="2021-10-03T00:00:00+00:00">
<meta itemprop=dateModified content="2021-10-03T00:00:00+00:00">
<meta itemprop=wordCount content="1201">
<meta itemprop=keywords content>
<meta name=referrer content="no-referrer-when-downgrade">
<link href=https://sverona.dev/css/base.css type=text/css rel=stylesheet>
<link href=https://sverona.dev/css/sidenotes.css type=text/css rel=preload as=style onload="this.onload=null,this.rel='stylesheet'">
<link href=https://sverona.dev/css/latex-theorem.css type=text/css rel=preload as=style onload="this.onload=null,this.rel='stylesheet'">
<link href=https://sverona.dev/katex/katex.css type=text/css rel=preload as=style onload="this.onload=null,this.rel='stylesheet'">
<script defer src=https://sverona.dev/katex/katex.js></script>
<script defer src=https://sverona.dev/katex/contrib/auto-render.js></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"\\(",right:"\\)",display:!1},{left:"\\begin{align}",right:"\\begin{align}",display:!0},{left:"\\[",right:"\\]",display:!0}]})})</script>
</head>
<body>
<header id=header><a href=/ class=title id=brand>
<span id=accent></span>S. Verona Malone
</a>
<nav><ul>
<li><a href=/blog>blog</a></li>
<li><a href=https://github.com/sverona>github</a></li>
<li><a href=/trig>MATH 117</a></li>
</ul>
</nav>
</header>
<main>
<header id=front-matter>
<nav>
<div id=current-section>
<a href=https://sverona.dev/blog/mern/>Annotations for a minimal MERN repo</a>
</div>
<div id=next-prev>
<span>
&lt;-- <a href=https://sverona.dev/blog/mern/backend/>Annotated MERN II: Backend</a>
</span>
<span>
</span>
</div>
</nav>
<div>
<time datetime=2021-10-03 pubdate>
October 3, 2021
</time>
<h1>Annotated MERN III: Frontend</h1>
<em id=page-description>Annotations for the React part of the repo.</em>
<br>
</div>
</div>
</header>
<article>
<div id=toc class=margin-toggle>
<h2>Contents</h2>
<nav id=TableOfContents>
<ul>
<li><a href=#package-lockjson>package-lock.json</a></li>
<li><a href=#packagejson>package.json</a></li>
<li><a href=#src>src/</a>
<ul>
<li><a href=#appcss-indexcss>App.css, index.css</a></li>
<li><a href=#indexjs>index.js</a></li>
<li><a href=#appjs>App.js</a></li>
<li><a href=#componentstasklistjs>components/TaskList.js</a></li>
</ul>
</li>
<li><a href=#srcpublic>src/public/</a></li>
</ul>
</nav>
</div>
<p>This post continues our look at <a href=https://github.com/jmsv>James Vickery</a>&rsquo;s <a href=https://github.com/jmsv/simple-mern>simple-mern</a> repository. Today we&rsquo;ll look at the React frontend, under the <code>client/</code> folder.</p>
<h2 id=package-lockjson>package-lock.json</h2>
<p>We&rsquo;ll ignore <code>package-lock.json</code>, since it was covered <a href=../node>previously</a>.</p>
<h2 id=packagejson>package.json</h2>
<p><code>package.json</code> looks very similar to what <code>create-react-app</code> spits out. There are some new options, though, so let&rsquo;s look at them.</p>
<div class=highlight><pre tabindex=0 style=color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>  {
    &#34;proxy&#34;: <span style=color:#cd0000>&#34;http://localhost:5000/&#34;</span>,
    &#34;eslintConfig&#34;: {
      &#34;extends&#34;: <span style=color:#cd0000>&#34;react-app&#34;</span>
    },
    &#34;browserslist&#34;: [
      <span style=color:#cd0000>&#34;&gt;0.2%&#34;</span>,
      <span style=color:#cd0000>&#34;not dead&#34;</span>,
      <span style=color:#cd0000>&#34;not ie &lt;= 11&#34;</span>,
      <span style=color:#cd0000>&#34;not op_mini all&#34;</span>
    ]
  }
</code></pre></div><p>These are all development-only options, in a sense:</p>
<ul>
<li><code>proxy</code> sets the root path of your application in development mode. So with this setting, in development mode, <code>/</code> resolves to <code>localhost:5000/</code>, but in production it&rsquo;ll resolve to the actual URL your app is being served from, e.g., <code>https://yoursite.github.io/</code>.</li>
<li><code>eslintConfig</code> is for the <code>eslint</code> utility, which is a highly configurable linter, similar to <code>pylint</code>. The option <code>extends</code> tells <code>eslint</code> to use the <a href=https://www.npmjs.com/package/eslint-config-react-app><code>eslint-config-react-app</code></a> preset by default. These are just sane default coding standards for a React app.</li>
<li><a href=https://www.npmjs.com/package/browserslist><code>browserslist</code></a> is used by a few different packages, most prominently <code>babel</code>, to keep track of necessary polyfills. The options in that array denote the criteria for a particular browser to be supported. They are fairly self-explanatory; <code>ie</code> is Internet Explorer and <code>op_mini</code> is Opera Mini.</li>
</ul>
<p>Let&rsquo;s also look at the <code>dependencies</code> and <code>scripts</code>:</p>
<div class=highlight><pre tabindex=0 style=color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  &#34;dependencies&#34;: {
    &#34;react&#34;: <span style=color:#cd0000>&#34;^16.7.0&#34;</span>,
    &#34;react-dom&#34;: <span style=color:#cd0000>&#34;^16.7.0&#34;</span>,
    &#34;react-scripts&#34;: <span style=color:#cd0000>&#34;2.1.2&#34;</span>
  },
  &#34;scripts&#34;: {
    &#34;start&#34;: <span style=color:#cd0000>&#34;react-scripts start&#34;</span>,
    &#34;build&#34;: <span style=color:#cd0000>&#34;react-scripts build&#34;</span>,
    &#34;test&#34;: <span style=color:#cd0000>&#34;react-scripts test&#34;</span>,
    &#34;eject&#34;: <span style=color:#cd0000>&#34;react-scripts eject&#34;</span>
  }
}
</code></pre></div><p>The only dependencies we have right now are</p>
<ul>
<li><code>react</code>, which is of course our frontend framework,</li>
<li><a href=https://reactjs.org/docs/react-dom.html><code>react-dom</code></a>, which allows us to insert React components directly into the DOM, and</li>
<li><code>react-scripts</code>, which is a collection of scripts that comes with <code>create-react-app</code>. The options explain themselves: <code>start</code> starts the server, <code>build</code> builds your app, and <code>test</code> runs the test harness. <code>eject</code> is how you get out of the <code>create-react-app</code> ecosystem.</li>
</ul>
<p>In fact, <code>create-react-app</code> is hiding quite a lot of dependencies from us, and running <code>npm run eject</code> will show them. It&rsquo;ll also reveal the Webpack configuration, some Jest configuration, and a host of other things. For now we&rsquo;ll leave all this in the box, though.</p>
<h2 id=src>src/</h2>
<h3 id=appcss-indexcss>App.css, index.css</h3>
<p>This is just CSS. I&rsquo;ll ignore it for now. <code>index.css</code> in particular is autogenerated by <code>create-react-app</code>.</p>
<h3 id=indexjs>index.js</h3>
<p>This is the first file compiled, and all it does is tell <code>react-dom</code> to render the <code>App</code> component, so there&rsquo;s not much to see here.</p>
<div class=highlight><pre tabindex=0 style=color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#cdcd00>import</span> React from <span style=color:#cd0000>&#39;react&#39;</span>;
<span style=color:#cdcd00>import</span> ReactDOM from <span style=color:#cd0000>&#39;react-dom&#39;</span>;
<span style=color:#cdcd00>import</span> <span style=color:#cd0000>&#39;./index.css&#39;</span>;
<span style=color:#cdcd00>import</span> App from <span style=color:#cd0000>&#39;./App&#39;</span>;

ReactDOM.render(&lt;App /&gt;, <span style=color:#cd00cd>document</span>.getElementById(<span style=color:#cd0000>&#39;root&#39;</span>));
</code></pre></div><h3 id=appjs>App.js</h3>
<p>Here we get the real meat of the application. First, the imports.</p>
<div class=highlight><pre tabindex=0 style=color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#cdcd00>import</span> React, { useState, useEffect, useCallback } from <span style=color:#cd0000>&#39;react&#39;</span>;
<span style=color:#cdcd00>import</span> <span style=color:#cd0000>&#39;./App.css&#39;</span>;

<span style=color:#cdcd00>import</span> TasksList from <span style=color:#cd0000>&#39;./components/TaskList&#39;</span>;
</code></pre></div><p>The remainder of the application is a React component, written as a function. The more traditional style is to write this as a class that extends <code>React.Component</code>.</p>
<p>(Talk some about how these styles differ &ndash; hooks vs state.)</p>
<div class=highlight><pre tabindex=0 style=color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#cdcd00>const</span> App <span style=color:#39c>=</span> () =&gt; {
...
};
</code></pre></div><p>Within this component, the first thing we encounter is some app-level state. This is implemented through React&rsquo;s <code>useState</code> hook, which returns a getter and setter for a state field. We just pass in the field&rsquo;s initial value.</p>
<div class=highlight><pre tabindex=0 style=color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#cdcd00>const</span> [tasks, setTasks] <span style=color:#39c>=</span> useState([]);
<span style=color:#cdcd00>const</span> [newTaskTitle, setNewTaskTitle] <span style=color:#39c>=</span> useState(<span style=color:#cd0000>&#39;&#39;</span>);
</code></pre></div><p>Next we encounter a React <em>effect hook</em>. This specifies something that will happen when the component loads. The name <em>effect</em> is intended to evoke <em>side effect.</em></p>
<div class=highlight><pre tabindex=0 style=color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#cdcd00>const</span> getTasks <span style=color:#39c>=</span> useCallback(() =&gt; {
  fetch(<span style=color:#cd0000>&#39;/api/tasks&#39;</span>)
    .then(res =&gt; res.json())
    .then(setTasks);
});

useEffect(() =&gt; {
  getTasks();
}, []);
</code></pre></div><p>The effect <code>getTasks</code> runs an API call to pull the task list from Mongo. We saw the meat of this API call in <a href=../backend>the backend post</a>. Then it sets the task list inside the app.</p>
<p>The next thing we come to is an <em>event handler</em>.</p>
<div class=highlight><pre tabindex=0 style=color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#cdcd00>const</span> clickAddTask <span style=color:#39c>=</span> event =&gt; {
  event.preventDefault();

  fetch(<span style=color:#cd0000>&#39;/api/tasks/add&#39;</span>, {
    method<span style=color:#39c>:</span> <span style=color:#cd0000>&#39;post&#39;</span>,
    headers<span style=color:#39c>:</span> { <span style=color:#cd0000>&#39;Content-Type&#39;</span><span style=color:#39c>:</span> <span style=color:#cd0000>&#39;application/json&#39;</span> },
    body<span style=color:#39c>:</span> JSON.stringify({ title<span style=color:#39c>:</span> newTaskTitle }),
  }).then(() =&gt; {
    setNewTaskTitle(<span style=color:#cd0000>&#39;&#39;</span>);
    getTasks();
  });
};
</code></pre></div><p>As we&rsquo;ll see below, and as the name implies, this fires upon clicking the &ldquo;Add Task&rdquo; button.</p>
<p>Ordinarily, clicking on the submit button would reload the page; we call <code>event.preventDefault()</code> to stop this from happening.</p>
<p>Then we send an API call to the server to actually add the task to Mongo. Having done that, we reset the value of the title box (<code>setNewTaskTitle('')</code>) and update the task list (<code>getTasks()</code>.)</p>
<p>Finally, we have the component&rsquo;s actual HTML structure. This would appear under the <code>render()</code> method in a component class.</p>
<div class=highlight><pre tabindex=0 style=color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx>  <span style=color:#cdcd00>return</span> (
    &lt;div className<span style=color:#39c>=</span><span style=color:#cd0000>&#34;App&#34;</span>&gt;
      &lt;h1&gt;My Tasks&lt;/h1&gt;

      &lt;TasksList tasks<span style=color:#39c>=</span>{tasks} updateTasks<span style=color:#39c>=</span>{getTasks} /&gt;

      &lt;form onSubmit<span style=color:#39c>=</span>{clickAddTask}&gt;
        &lt;input
          type<span style=color:#39c>=</span><span style=color:#cd0000>&#34;text&#34;</span>
          size<span style=color:#39c>=</span><span style=color:#cd0000>&#34;30&#34;</span>
          placeholder<span style=color:#39c>=</span><span style=color:#cd0000>&#34;New Task&#34;</span>
          value<span style=color:#39c>=</span>{newTaskTitle}
          onChange<span style=color:#39c>=</span>{event =&gt; setNewTaskTitle(event.target.value)}
        /&gt;
        &lt;input className<span style=color:#39c>=</span><span style=color:#cd0000>&#34;btn-primary&#34;</span> type<span style=color:#39c>=</span><span style=color:#cd0000>&#34;submit&#34;</span> value<span style=color:#39c>=</span><span style=color:#cd0000>&#34;Add&#34;</span> /&gt;
      &lt;/form&gt;
    &lt;/div&gt;
  );
</code></pre></div><p>The form structure is nothing new, although some keywords (<code>className</code>, for one) have been changed to avoid collision with JavaScript reserved words.</p>
<p>The interesting part is the <code>TasksList</code> line:</p>
<div class=highlight><pre tabindex=0 style=color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx>  &lt;TasksList tasks<span style=color:#39c>=</span>{tasks} updateTasks<span style=color:#39c>=</span>{getTasks} /&gt;
</code></pre></div><p>This renders a <code>TaskList</code> component with two <em>properties.</em> We&rsquo;ll see in a moment where these properties are used.</p>
<h3 id=componentstasklistjs>components/TaskList.js</h3>
<p>This file specifies the structure of the <code>TaskList</code> component. There are two component methods and the HTML structure to look at, but first let&rsquo;s examine the signature.</p>
<div class=highlight><pre tabindex=0 style=color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#cdcd00>const</span> TaskList <span style=color:#39c>=</span> ({ tasks, updateTasks }) =&gt; [...]
</code></pre></div><p>If this component were a class, its constructor would take an optional <code>props</code> argument containing component-level <em>properties</em>. These properties, <code>tasks</code> and <code>updateTasks</code>, are what we just saw above.</p>
<p><code>updateTasks</code> is a function, so thinking of it as a <em>property</em> may be strange. It&rsquo;s set up this way because <code>updateTasks</code> is defined along with <code>tasks</code> at the application level. It may be a poor architectural decision, but for an app of this size it&rsquo;s probably not worth worrying about.</p>
<p>Let&rsquo;s look at the component methods.</p>
<div class=highlight><pre tabindex=0 style=color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx>  <span style=color:#cdcd00>const</span> clickDeleteTask <span style=color:#39c>=</span> (event, task) =&gt; {
    event.preventDefault();

    fetch(<span style=color:#cd0000>`/api/tasks/delete/</span><span style=color:#cd0000>${</span>task._id<span style=color:#cd0000>}</span><span style=color:#cd0000>`</span>, {
      method<span style=color:#39c>:</span> <span style=color:#cd0000>&#39;delete&#39;</span>,
    })
      .then(res =&gt; res.json())
      .then(() =&gt; updateTasks());
  };
</code></pre></div><p>This is an event handler. Nothing new here; this simply stops anything that would normally happen when you click on the trigger, runs an API call to delete the passed task instead, and updates the task list.</p>
<div class=highlight><pre tabindex=0 style=color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx>  <span style=color:#cdcd00>const</span> toggleDone <span style=color:#39c>=</span> task =&gt; {
    fetch(<span style=color:#cd0000>`/api/tasks/update/</span><span style=color:#cd0000>${</span>task._id<span style=color:#cd0000>}</span><span style=color:#cd0000>`</span>, {
      method<span style=color:#39c>:</span> <span style=color:#cd0000>&#39;post&#39;</span>,
      headers<span style=color:#39c>:</span> { <span style=color:#cd0000>&#39;Content-Type&#39;</span><span style=color:#39c>:</span> <span style=color:#cd0000>&#39;application/json&#39;</span> },
      body<span style=color:#39c>:</span> JSON.stringify({ done<span style=color:#39c>:</span> <span style=color:#39c>!</span>task.done }),
    }).then(() =&gt; updateTasks());
  };
</code></pre></div><p>More of the same here. API call to update the task, then update the task list.</p>
<p>Now let&rsquo;s check out the HTML structure.</p>
<div class=highlight><pre tabindex=0 style=color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=color:#cdcd00>return</span> (
  &lt;ul className<span style=color:#39c>=</span><span style=color:#cd0000>&#34;tasks&#34;</span>&gt;
    {tasks.map(task =&gt; (
      &lt;li key<span style=color:#39c>=</span>{task._id}&gt;
        &lt;label className<span style=color:#39c>=</span>{task.done <span style=color:#39c>?</span> <span style=color:#cd0000>&#39;done&#39;</span> <span style=color:#39c>:</span> <span style=color:#cd0000>&#39;&#39;</span>}&gt;
          &lt;input
            type<span style=color:#39c>=</span><span style=color:#cd0000>&#34;checkbox&#34;</span>
            checked<span style=color:#39c>=</span>{task.done}
            onChange<span style=color:#39c>=</span>{() =&gt; toggleDone(task)}
          /&gt;{<span style=color:#cd0000>&#39; &#39;</span>}
          {task.title}
          &lt;svg
            onClick<span style=color:#39c>=</span>{event =&gt; clickDeleteTask(event, task)}
            className<span style=color:#39c>=</span><span style=color:#cd0000>&#34;delete-button&#34;</span>
            <span>[</span>...<span>]</span>
          &gt;
          [...]
          &lt;/svg&gt;
        &lt;/label&gt;
      &lt;/li&gt;
    ))}
  &lt;/ul&gt;
);
</code></pre></div><p>This simply renders a <code>&lt;li></code> for each task containing a toggle box, a title, and an SVG (whose fiddly details I have omitted) that functions as the delete button. (It renders to an X.)</p>
<p>There&rsquo;s only one new feature to discuss:</p>
<div class=highlight><pre tabindex=0 style=color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx>&lt;li key<span style=color:#39c>=</span>{task._id}&gt;
</code></pre></div><p>A React <em>key</em> is just what it sounds like: a unique identifier. (For this task item, we just use the unique ID that Mongo assigns it.) Without them, we&rsquo;d have to rerender the entire component every time one of the tasks changed. With them, React will search for the key and rerender only the item that matches.</p>
<h2 id=srcpublic>src/public/</h2>
<p>This contains some files autogenerated by <code>create-react-app</code>. <code>index.js</code> plugs in here. Otherwise there&rsquo;s not much to say.</p>
</article>
<hr>
</main>
<footer> Made with <a href=https://github.com/sverona/hugo-semiotic>Hugo Semiotic</a>
</footer>
</body>
</html>